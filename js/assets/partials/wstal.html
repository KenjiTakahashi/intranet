<div id='floatBox' ng-controller="wstalCtrl">
    <div id="latesTodayWrapper">
        <div id="floatDiv" ng-show="show_box">
            <table class="table table-bordered presence" id="late" ng-show="!(get_lates().length == 0 && get_absences().length == 0)">
                <thead>
                    <tr>
                        <th class="lates-column-close">
                        </th>
                        <th class="lates-column-user">
                            <span data-placement="bottom" bs-tooltip="'User first name and last name'">User</span>
                        </th>
                        <th class="lates-column-from">
                            <span data-placement="bottom" bs-tooltip="'<b>For late today:</b> time of leaving work (absent since day start if empty)<br /><b>For off today:</b> first day of absence'">From</span>
                        </th>
                        <th class="lates-column-to">
                            <span data-placement="bottom" bs-tooltip="'<b>For late today:</b> time of going back to work (absent till day end if empty)<br /><b>For off today:</b> last day of absence'">To</span>
                        </th>
                    </tr>
                </thead>
            </table>
            <div id="latesTodayContentWrapper">
                <table class="table table-bordered presence" id="late">
                    <tbody>
                        <tr ng-show="get_lates().length == 0 && get_absences().length == 0">
                            <td colspan='4' class="lates-column-header" id="empty_box">
                                E M P T Y !
                            </td>
                        </tr>
                        <tr ng-show="get_lates().length > 0" class="late-light">
                            <td colspan="4" class="lates-column-header">LATE TODAY</td>
                        </tr>
                        <tr class='late-record' ng-repeat="user in get_lates()" data-placement="left" bs-tooltip="user.explanation">
                            <td>
                                <button class="close" aria-hidden="true" ng-click="openRemovalConfirmation(user)">×</button>
                            </td>
                            <td class="lates-column-user">
                                <span class="name" ng-bind="user.name"></span>
                                <span class="new-late-label" ng-show="newLatesIds.indexOf(user.late_id) != -1">(NEW)</span>
                            </td>
                            <td class="lates-column-from">{{ user.start  && (set_time(user.start) | date:'HH:mm') || '-'}}</td>
                            <td class="lates-column-to">{{ user.end  && (set_time(user.end) | date:'HH:mm') || '-'}}</td>
                        </tr>

                    <tr ng-show="get_absences().length > 0">
                        <td colspan="4" class="lates-column-header">OFF TODAY</td>
                    </tr>
                    <tr class="absence-record" ng-repeat="user in get_absences()" data-placement="left" bs-tooltip="user.remarks">
                        <td>
                            <button class="close" aria-hidden="true" ng-click="openRemovalConfirmation(user)">×</button>
                        </td>
                        <td class="lates-column-user">
                            <span class="name" ng-bind="user.name"></span>
                            <span class="new-late-label" ng-show="newAbsencesIds.indexOf(user.absence_id) != -1">(NEW)</span>
                        </td>
                        <td class="lates-column-from">{{ user.start  && (set_time(user.start) | date:'MM.dd') || '-'}}</td>
                        <td class="lates-column-to">{{ user.end  && (set_time(user.end) | date:'MM.dd') || '-'}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div id="floatBar">
        <div id="new-lates-button">
            <div id="lates-quantity" title="Total lates quantity">{{ get_lates().length }}</div>
            <div id="absences-quantity" title="Total absences quantity">{{ get_absences().length }}</div>
            <div ng-show="newLatesQuantity > 0" ng-click="show()" id="new-quantity" title="New lates and absences quantity">{{ newLatesQuantity }}</div>
        </div>
        <div ng-click="show()" class="badge" title="Click to show the list of lates and absences">
            Late today
        </div>
        <span ng-click="openModal()" ng-show="show_box" class="badge" title="Click to configure your black list">Settings</span>
    </div>


    <div id="dialogRemovalConfirmation" title="Add this person to black list?">
      <p>
        Are you sure you want to add <b id="proposalName"></b> to your black list? <br />
        <h6>
            <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
            Remember that you can adjust your black list later in the settings.
        </h6>
      </p>
    </div>
</div>